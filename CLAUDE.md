# 일민미술관 전시보고서 생성기 v3

## 프로젝트 개요

일민미술관의 전시보고서를 자동 생성하는 Streamlit 웹 앱입니다.
v2(기존 보고서 형식 재현)에서 v3(분석 통합형)으로 도약한 버전입니다.

## v3 핵심 철학

- **입력 최소화, 분석 자동화**: 정량 데이터를 입력하면 과거 18개 전시와 비교 분석이 자동 생성
- **분석이 보고서에 녹아든다**: 분석 인사이트가 별도 섹션이 아니라 해당 보고서 장(章)에 인라인 배치
- **평가 초안 자동 생성**: 데이터 패턴에서 긍정/부정/개선 방안 문장을 자동 도출, 큐레이터는 수정만

## 4탭 워크플로우

```
📋 기반 정보(B) → 📊 정량 데이터(A) → 🔍 분석 & 평가(C) → 📄 보고서 생성
```

### 탭 B: 기반 정보 (tab_base.py)
보고서의 서술적 정보. 분석 대상이 아닌 것들.
- 전시 기본 (제목, 기간, 작가, 기획진)
- 전시 주제 에세이
- 전시실 구성 (도면, 사진)
- 프로그램 상세 (구분/제목/일자 — 숫자는 A에서)
- 운영인력 역할 서술
- 인쇄물, 홍보 방식, 언론보도 리스트
- 멤버십, 관객 후기

### 탭 A: 정량 데이터 (tab_data.py)
분석의 대상이 되는 모든 숫자. 레퍼런스 Excel 52개 컬럼과 대응.
- 예산: 총예산, 전시비, 부대비, 계획액, 수입, 입장수입
- 관객: 총관객, 입장권별(일반/학생/초대/예술인패스/디스커버서울패스/기타), 단체, 오프닝
- 작품: 총수 + **매체별 구성** (회화/조각/사진/설치/미디어/기타) ← v3 신규
- 프로그램: 수, 회차, 참여인원, 도슨트(정기/특별)
- 인력: 총원, 유급, 봉사자
- 홍보: 보도건수, 웹초청장, 뉴스레터 오픈율, SNS 게시/피드백, 멤버십

### 탭 C: 분석 & 평가 (tab_analysis.py)
A의 데이터를 레퍼런스와 비교하여 자동 생성.
- **섹션별 인사이트**: 각 인사이트에 보고서 배치 위치(section) 태그 부여
  - "results" → IV. 전시 결과에 배치
  - "composition" → III. 전시 구성에 배치
  - "promotion" → V. 홍보에 배치
  - "evaluation" → VI. 평가에 배치
- **평가 초안**: 긍정/부정/개선 방안 자동 도출
- 모든 텍스트 편집 가능, 체크박스로 채택/기각

### 탭 D: 보고서 생성 (tab_generate.py)
- 데이터 완성도 체크 (프로그레스 바)
- 보고서 구조 미리보기 (인사이트 인라인 배치 확인)
- Word 보고서 생성 / JSON 저장·불러오기

## 파일 구조

```
exhibition-report-generator-v3/
├── app.py                  # 메인 앱 (232줄)
├── tabs/
│   ├── __init__.py
│   ├── tab_base.py         # B: 기반 정보 (258줄)
│   ├── tab_data.py         # A: 정량 데이터 (214줄)
│   ├── tab_analysis.py     # C: 분석 & 평가 (176줄)
│   └── tab_generate.py     # D: 생성 (398줄)
├── analysis_engine.py      # 분석 엔진 (673줄)
├── report_generator.py     # Word 보고서 생성 (465줄)
├── reference_data.py       # 레퍼런스 Excel 관리 (534줄, v2 이관)
├── chart_generator.py      # 차트 생성 (312줄, v2 이관)
├── styles.py               # Word 스타일 시스템 (591줄, v2 이관)
├── utils.py                # 공통 헬퍼 (124줄)
├── exhibition_reference_data.xlsx  # 18개 전시 레퍼런스
├── requirements.txt
└── packages.txt
```

## v2 → v3 변경 요약

| 항목 | v2 | v3 |
|------|----|----|
| 탭 수 | 8개 | 4개 |
| 분석 위치 | 별도 탭 (보고서 VI장에만) | 보고서 각 섹션에 인라인 |
| 레퍼런스 활용 | 52개 중 15개 | 52개 중 35개+ |
| 매체별 작품 | 미지원 | 회화/조각/사진/설치/미디어/기타 |
| 예산 구조 분석 | 없음 | 전시비/부대비 비율 비교 |
| 인력 효율 분석 | 없음 | 관객/인력 비율 비교 |
| 평가 초안 | 완전 수동 입력 | 데이터 기반 자동 생성 |
| 데이터 입력 | 서술+숫자 혼재 | B(서술) / A(숫자) 명확 분리 |

## 분석 엔진 카테고리

| 카테고리 | 아이콘 | 보고서 배치 | 분석 내용 |
|---------|--------|-----------|----------|
| 관객 | 👥 | results | 총관객, 일평균, 유료비율, 학생, 예술인패스 |
| 예산 | 💰 | results | 총예산, 관객당비용, 예산구조, 회수율 |
| 프로그램 | 🎯 | composition | 수, 참여인원, 참여율 |
| 작품 | 🎨 | composition | 총수, 매체별 구성 비율 |
| 홍보 | 📢 | promotion | 보도건수, 보도건당관객, SNS |
| 인력 | 👷 | composition | 인력당 관객 |
| 교차분석 | 🔗 | evaluation | 예산vs관객, 홍보vs관객, 수입vs예산 |

## 전시 유형 분류

- 유형 1: 정기 기획전 (10개)
- 유형 2: 특별전 (5개)
- 유형 3: 기타 (2개)
- 유형 0: 분석 제외 (1개) — 모든 분석에서 자동 제외

비교 분석 시 동일 유형 우선 비교. 같은 유형이 3개 미만이면 전체(유형 0 제외)로 폴백.
통계 기준: 평균(mean) 사용 (중앙값 아님).

## 레퍼런스 Excel 구조

- Row 1: 카테고리 헤더 (병합 셀) — 건너뜀
- Row 2: 실제 컬럼명 (52개)
- Row 3+: 전시 데이터 (18행)
- "-" 또는 빈 칸은 NaN 처리

## 스타일 사양

Word 보고서의 스타일은 styles.py에 정의. v2와 동일한 스타일 시스템 사용:
- 글꼴: Noto Sans CJK KR (본문 10pt, 제목 16pt)
- 용지: A4, 여백 상하좌우 2cm
- 제목 체계: I. → 1. → 1) → ① ② ③
- 차트: matplotlib, 한국어 폰트 폴백 체인

## Streamlit Cloud 배포 참고

- Python 3.9+
- packages.txt: 시스템 패키지 (fonts-noto-cjk 등)
- requirements.txt: Python 패키지

## 알려진 제한사항 (초안)

- 이미지 업로드는 세션 종료 시 소실 (tempfile 사용)
- 평가 초안의 문장 다양성이 제한적 (규칙 기반)
- 조사 처리("이/가", "은/는") 일부 매체명에서 어색할 수 있음
- 주별 관객수 입력 UI 미구현 (v2에서 이관 필요)
